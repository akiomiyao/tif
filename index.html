<html>
  <head>
    <link rel = "stylesheet" href = "default.css">
  </head>
  <body>
<h1>Transopson Insertion Finder (TIF) <font size = "4"> - An efficient detector for insertions of transposable element from NGS data</font></h1>
TIF detectes transposition of transpososable elements from sequence data of NGS. This page explains how to use TIF, using the transposition detection of the rice endogenous retrotransposon <i>Tos17</i> as an example.<br>
Code: <a href = "https://github.com/akiomiyao/tif" target = "_blank">https://github.com/akiomiyao/tif</a><br>
Paper: <a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-15-71" target = "_blank">Nakagome M, Solovieva E, Takahashi A, Yasue H, Hirochika H, Miyao A (2014) Transposon Insertion Finder (TIF): a novel program for detection of de novo transpositions of transposable elements. BMC Bioinformatics 5:71.</a>
<h2><i>Tos17</i> across the century</h2>
<p><img src = "tos17.gif" align = "left">
<i>Tos17</i> is an endogenous retrotransposon of rice. <i>Tos17</i> is active only in cultured cells of <i>Japonica</i> rice cultivar Nipponbare (<a href = "https://doi.org/10.1073/pnas.93.15.7783" target = "_blank">Hirochika <i>et al.</i> 1996</a>). Taking advantage of this property, we created about 50,000 lines of mutant panels from rice individuals regenerated from cultured cells (<a href = "https://doi.org/10.1105/tpc.012559" target = "_blank">Miyao <i>et al.</i> 2003</a>). Insertion sites of <i>Tos17</i> are determined by <a href = "https://doi.org/10.5511/plantbiotechnology.15.253" target = "_blank">the Suppression PCR and TAIL-PCR methods</a>, and are published in the <a href = "https://tos.nias.affrc.go.jp/" target = "_blank">mutant panel database</a>. <i>Tos17</i> insertion mutant lines have been distributed to researchers around the world and are <a href = "https://scholar.google.com/scholar?hl=ja&as_sdt=0%2C5&q=tos17&btnG=" target = "_blank">useful for functional analysis of genes</a>.
<p>Before the development of NGS technology, primer set of a primer having a <i>Tos17</i> sequence near the end of <i>Tos17</i> and  a primer with a special modification at the end, or a short primer with the elaborate reaction cycles was used to amplify the DNA fragment containing the flanking sequence of <i>Tos17</i> insertion point. Amplified fragments were separated by agarose gel electrophoresis, and the DNA obtained from the gel block containing the fragment was used as a template to determine the flanking sequence of <i>Tos17</i> insertion point by the Sanger method.
<p>We tried to determine insertion positions of <i>Tos17</i> for all 50,000 lines. It was costly and required several years. Furthermore, amplification of flanking sequences depends on recognition sites of restriction enzyme or by-chance primer annealing, making it difficult to cover all insertion sites.
<h2><i>Tos17</i> in this century with NGS</h2>
<p>NGS technology has made it possible to obtain the entire genome sequence of rice individuals. The junction created by <i>Tos17</i> insertion should also be included in the large number of short reads. Sequences having a junction with <i>Tos17</i> can be easily selected by searching the sequences at both ends of <i>Tos17</i>. It is known that a 5-base duplication occurs at the target site during the insertion of <i>Tos17</i>. <a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-15-71/figures/1" target = "_blank">The insertion site of <i>Tos17</i> can be detected by selecting a set having the same 5 base target site duplication (TSD) in the 5'-end and the 3'-end-flankng sequence of <i>Tos17</i></a>. TIF selects short reads containing 5'-end and 3'-end sequence of transposable element, makes set of 5'-end and the 3'-end-flankng sequence having same TSD sequence, and then output inserted position on the reference genome by mapping pair of flanking seqeunces.
<h2>Detection of <i>Tos17</i> insertion from NGS data</h2>
<p>Once the NGS sequence data of the <i>Tos17</i> insertion mutant individual is obtained, the insertion site can be easily obtained by the <a href = "https://github.com/akiomiyao/tif" target = "_blank">TIF</a> program. A computer running Unix (<a href = "https://ubuntu.com" target = "_blank">ubuntu</a> is good), NGS data, and the rice reference genome sequence (<a href = "https://rapdb.dna.affrc.go.jp/download/irgsp1.html" target = "_blank">IRGSP1.0</a>) are required.
<p>Following is an example.
<p>To obtain short read sequence, fastq-dump is required. <a href = "https://akiomiyao.github.io/ped/sratoolkit/index.html" target = "_blank">Link to fastq-dump setup</a><br>
git clone and wget reference is required at first analysis.
<pre>$ git clone https://github.com/akiomiyao/tif.git
$ cd git
$ mkdir ttm5
$ mkdir ttm5/read
$ cd ttm5/read
$ fastq-dump --split-files SRR556174   # Fastq-dump takes long time.
$ fastq-dump --split-files SRR556175

$ cd git
$ wget https://rapdb.dna.affrc.go.jp/download/archive/irgsp1/IRGSP-1.0_genome.fasta.gz
$ perl tif.pl IRGSP-1.0_genome.fasta.gz ttm5 TGTTAAATATATATACA TTGCAAGTTAGTTAAGA
or
$ perl tif.pl ref=IRGSP-1.0_genome.fasta.gz,target=ttm5,head=TGTTAAATATATATACA,tail=TTGCAAGTTAGTTAAGA (New format for options)
</pre>
<p>'<a href = "https://doi.org/10.1186/1471-2229-10-175" target = "_blank">ttm5</a>' is one of the <i>Tos17</i> insertion line (line name: ND6834). The NGS data of ttm5 was acquired for <a href = "https://doi.org/10.1093/pcp/pcr172" target = "_blank">the analysis of somaclonal variation</a>. ND6834 was harvested as a regenerated individual in October 1998. The individual was regenerated from liquid culture in N6 medium containing 2,4-dichlorophenoxyacetic acid at a concentration of 1 mg/L until March 1998 from the Nipponbare calus induced in October 1997. The individual analyzed by NGS is the M<sub>4</sub> generation, two generations after the harvested seeds. <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=SRR556174" target = "_blank">SRR556174</a> and <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=SRR556175" target = "_blank">SRR556175</a> are run data of ttm5 by Illumina Hiseq2000 sequencing system.
<p>without argument returns how to use tif.pl.<br>
$ perl tif.pl<br>
'$' at the head of line indicates prompt of terminal window.<br>
<p>$ perl tif.pl reference target_directory 5'-end_of_TE_sequence 3'-end_of_TE_sequence<br>
or<br>
$ perl tif.pl ref=reference,target=target_directory,head=5'-end_of_TE_sequence,tail=3'-end_of_TE_sequence<br><br>

In the new option format, space after commas is not allowed.<br><br> 

For analysis of rice, IRGSP-1.0_genome.fasta.gz is the reference genome sequence.<br>
NGS fastq files should be seved in target/read directory<br>
<i>Tos17</i> 5'-end (Head) sequence: TGTTAAATATATATACA<br>
<i>Tos17</i> 3'-end (Tail) sequence: TTGCAAGTTAGTTAAGA<br>
<p>Result of tif.pl is saved in target (ttm5) directory.
<pre>
% ll
total 516
drwxrwxr-x  4 miyao miyao   4096 Jan  4 14:46 ./
drwxrwxr-x 11 miyao miyao 155648 Jan  4 23:50 ../
drwxrwxr-x  2 miyao miyao   4096 Jan  4 14:46 child/
lrwxrwxrwx  1 miyao miyao     54 Jan  3 19:24 read
-rw-rw-r--  1 miyao miyao 264216 Jan  3 19:35 tif_grep.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
-rw-rw-r--  1 miyao miyao  43407 Jan  4 19:09 tif_log.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
-rw-rw-r--  1 miyao miyao   2522 Jan  4 19:09 tif_result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
-rw-rw-r--  1 miyao miyao   2979 Jan  4 19:09 tif_result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA.vcf
drwxrwxr-x  2 miyao miyao  36864 Jan  3 19:36 tmp/
</pre>
<p>tif_head_seq.tail_seq.vcf is the result with vcf format.<br>
tif_grep.head_seq.tail_seq is the list of short reads containing head_seq or tail_seq.<br>
tif_log.head_seq.tail_seq is the log of run.<br>
tif_result.head_seq.tail_seq is the result of tif analysis.<br><br>
<b>Result with vcf format</b>
<pre>miyao:~/tif/ttm5$ cat tif_result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA.vcf 
##fileformat=VCFv4.3
##fileDate=20220104
##source=&lt;PROGRAM=tif.pl,target=ttm5,reference=IRGSP-1.0_genome.fasta&gt;
##INFO=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;
##INFO=&lt;ID=AF,Number=.,Type=Float,Description="Allele Frequency"&gt;
##INFO=&lt;ID=DP,Number=1,Type=Integer,Description="Approximate read depth"&gt;
##INFO=&lt;ID=SVTYPE,Number=1,Type=String,Description="Type of structural variant"&gt;
##INFO=&lt;ID=MEINFO,Number=9,Type=String,Description="Movile element info of the form ME_HEAD_SEQ,ME_TAIL_SEQ,JUNCTION_POS_OF_HEAD,JUNCTION_POS_OF_TAIL,TSD_SIZE,TSD_SEQUENCE,DIRECTION,COUNT_OF_READS_WITH_JUNCTION_OF_HEAD,COUNT_OF_READS_WITH_JUNCTION_OF_TAIL"&gt;
##ALT=&lt;ID=INS,Description="Insertion of a mobile element"&gt;
##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype"&gt;
##FORMAT=&lt;ID=AD,Number=.,Type=String,Description="Allelic depths for the reference and alternate alleles in the order listed"&gt;
##FORMAT=&lt;ID=DP,Number=1,Type=String,Description="Read Depth"&gt;
##created=&lt;TIMESTAMP="2022-01-04 19:09:29 +0900"&gt;
#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  ttm5
1       34453641        .       G       G&lt;INS&gt;  .       .       GT=1/1;AF=1;DP=23;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,34453641,34453645,5,CTTTG,reverse,3,20;SVTYPE=INS  GT:AD:DP   1/1:0,23:23
2       1004765 .       C       C&lt;INS&gt;  .       .       GT=1/0;AF=0.168;DP=89;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,1004765,1004769,5,ATACC,reverse,2,13;SVTYPE=INS        GT:AD:DP   1/0:74,15:89
2       31596632        .       T       T&lt;INS&gt;  .       .       GT=1/0;AF=0.47;DP=34;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,31596632,31596628,5,CTAAT,forward,2,14;SVTYPE=INS       GT:AD:DP    1/0:18,16:34
3       741222  .       C       C&lt;INS&gt;  .       .       GT=1/1;AF=1;DP=17;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,741222,741226,5,GCAGC,reverse,3,14;SVTYPE=INS      GT:AD:DP        1/1:0,17:17
3       8304674 .       A       A&lt;INS&gt;  .       .       GT=1/1;AF=1;DP=21;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,8304674,8304678,5,GAATA,reverse,2,19;SVTYPE=INS    GT:AD:DP        1/1:0,21:21
6       24967877        .       T       T&lt;INS&gt;  .       .       GT=1/1;AF=1;DP=29;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,24967877,24967881,5,TGCAT,reverse,4,25;SVTYPE=INS  GT:AD:DP   1/1:0,29:29
7       20064395        .       T       T&lt;INS&gt;  .       .       GT=1/0;AF=0.365;DP=82;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,20064395,20064391,5,CTTAT,forward,1,29;SVTYPE=INS      GT:AD:DP    1/0:52,30:82
7       20080556        .       T       T&lt;INS&gt;  .       .       GT=1/0;AF=0.365;DP=82;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,20080556,20080552,5,CTTAT,forward,1,29;SVTYPE=INS      GT:AD:DP    1/0:52,30:82
9       12970614        .       C       C&lt;INS&gt;  .       .       GT=1/1;AF=1;DP=24;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,12970614,12970618,5,CATGC,reverse,1,23;SVTYPE=INS  GT:AD:DP   1/1:0,24:24
10      19069889        .       G       G&lt;INS&gt;  .       .       GT=1/0;AF=0.194;DP=67;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,19069889,19069885,5,ACTTG,forward,3,10;SVTYPE=INS      GT:AD:DP    1/0:54,13:67
10      21583058        .       T       T&lt;INS&gt;  .       .       GT=1/0;AF=0.352;DP=34;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,21583058,21583054,5,CTTAT,forward,3,9;SVTYPE=INS       GT:AD:DP    1/0:22,12:34
12      2155895 .       C       C&lt;INS&gt;  .       .       GT=1/0;AF=0.18;DP=100;MEINFO=TGTTAAATATATATACA,TTGCAAGTTAGTTAAGA,2155895,2155899,5,GGAAC,reverse,1,17;SVTYPE=INS        GT:AD:DP   1/0:82,18:100
</pre>
<b>Table 1.</b> Table of <i>Tos17</i> transposed positions in ttm5. TIF output, 'tif_result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA' separated with TAB is converted to the html table. TSDs in flanking sequence are indicated with red. Genotype M : Homozygous mutant, H : Heterozygous mutant.
<table border style="font-size : 7pt">
<tr><th>Chr</th><th>Junction of head</th><th>Junction of tail</th><th>TSD size</th><th>TSD</th><th>Direction</th><th>Head flanking sequence (HFS)</th><th>Tail flanking sequence (TFS)</th><th>Detected number of HFS</th><th>Detected number of TFS</th><th>Detected number of wild type reads</th><th>Genotype</th></tr>
<tr><td align = "center">chr01</td><td align = "right">34453641</td><td align = "right">34453645</td><td align = "center">5</td><td align = "center">CTTTG</td><td align = "center">reverse</td><td>TAGCAAGAAGTATCTCATCAGAGCCACCTTCACTTATGGAAACTACGATGGGCTCAACTCGTCAGAGAAGGGTT<font color="red">CTTTG</font></td><td><font color="red">CTTTG</font>TTTATCTTTGGACTCCATATCGGTGTCAACTTCTGGACGACGGTAAACTTGACAAAGTGGGATCCATCGA</td><td align = "right">3</td><td align = "right">20</td><td align = "right">0</td><td align = "center">M</td></tr>
<tr><td align = "center">chr02</td><td align = "right">1004765</td><td align = "right">1004769</td><td align = "center">5</td><td align = "center">ATACC</td><td align = "center">reverse</td><td>GCACATTTTGCAAAATTTGAGATATACCATCCTGACCCACATGTCATTGACTCATGTGGGTTCTACATGTCATTGAT<font color="red">ATACC</font></td><td><font color="red">ATACC</font>AATGGCATATCTCAAACTTTGCAAAATTATAATGGCATGGCTCCAATTTACCCTTTTCTTTAAGAAATCAACA</td><td align = "right">2</td><td align = "right">13</td><td align = "right">74</td><td align = "center">H</td></tr>
<tr><td align = "center">chr02</td><td align = "right">31596632</td><td align = "right">31596628</td><td align = "center">5</td><td align = "center">CTAAT</td><td align = "center">forward</td><td>CAAACACCGTGTAATTTAGAGGGATGCTATATAACGGAATCTCGTTCAGACGGGATGATACCTACGAGGTATAAGTT<font color="red">CTAAT</font></td><td><font color="red">CTAAT</font>ACCTGTGAGAGTATCGACTTCAGATACCGGTGAGTATTGAATGATTCATGCGAGCTATCAGGTGATAC</td><td align = "right">2</td><td align = "right">14</td><td align = "right">18</td><td align = "center">H</td></tr>
<tr><td align = "center">chr03</td><td align = "right">741222</td><td align = "right">741226</td><td align = "center">5</td><td align = "center">GCAGC</td><td align = "center">reverse</td><td>TAGAACCGGCTGTCGGATGTGTTTACTGTGTTTGCTGGACATTTGGCAATCAACGTTGGTGGTG<font color="red">GCAGC</font></td><td><font color="red">GCAGC</font>CAGGGTTCCATCCCTTCCAGCTCAGGTGGATCGAGCTGTAGAATCTCTGGTTCACCATAAGTTAGT</td><td align = "right">3</td><td align = "right">14</td><td align = "right">0</td><td align = "center">M</td></tr>
<tr><td align = "center">chr03</td><td align = "right">8304674</td><td align = "right">8304678</td><td align = "center">5</td><td align = "center">GAATA</td><td align = "center">reverse</td><td>GCATAAAGAGTGAATCTCATTGAAGGAACAAAATGAACATTTCAATTTTTTTCAGCAGTCTCGGTAATCAAAGTTAT<font color="red">GAATA</font></td><td><font color="red">GAATA</font>TACCATTGCTCTATAGCACCTCTCTCTGGCAAAATATTAGCATTTTGTCTCAAGACCTCCTTATGACACTATATTA</td><td align = "right">2</td><td align = "right">19</td><td align = "right">0</td><td align = "center">M</td></tr>
<tr><td align = "center">chr06</td><td align = "right">24967877</td><td align = "right">24967881</td><td align = "center">5</td><td align = "center">TGCAT</td><td align = "center">reverse</td><td>TCTGGAAATGATAGAGTTGCCAGAATTGGCAGAATGGTCTTCTGTGGACTGTTTTTTTCCTGCTCTTCTTGAGGTG<font color="red">TGCAT</font></td><td><font color="red">TGCAT</font>CAGAGGATGCCCCAAGCTGAAACAATTGCCACCAGTTGTTCTCCCACCTGTAAGAATGAGTATATATGTATCTACC</td><td align = "right">4</td><td align = "right">25</td><td align = "right">0</td><td align = "center">M</td></tr>
<tr><td align = "center">chr07</td><td align = "right">20064395</td><td align = "right">20064391</td><td align = "center">5</td><td align = "center">CTTAT</td><td align = "center">forward</td><td>ACACACTCGCTCACAGTGGAGGACATTGTGGACAATGCAATCGTACTCCTGACTGCCGGTTATGGGAATTCGGCTGTT<font color="red">CTTAT</font></td><td><font color="red">CTTAT</font>CACCTTCTTGCTCCGGTACCTAGCTAATGATCCAGACATCCTTGGCAAGATAACCGAGGGTGAGCACCTAGTACTCTA</td><td align = "right">1</td><td align = "right">29</td><td align = "right">52</td><td align = "center">H</td></tr>
<tr><td align = "center">chr07</td><td align = "right">20080556</td><td align = "right">20080552</td><td align = "center">5</td><td align = "center">CTTAT</td><td align = "center">forward</td><td>ACACACTCGCTCACAGTGGAGGACATTGTGGACAATGCAATCGTACTCCTGACTGCCGGTTATGGGAATTCGGCTGTT<font color="red">CTTAT</font></td><td><font color="red">CTTAT</font>CACCTTCTTGCTCCGGTACCTAGCTAATGATCCAGACATCCTTGGCAAGATAACCGAGGGTGAGCACCTAGTACTCTA</td><td align = "right">1</td><td align = "right">29</td><td align = "right">52</td><td align = "center">H</td></tr>
<tr><td align = "center">chr09</td><td align = "right">12970614</td><td align = "right">12970618</td><td align = "center">5</td><td align = "center">CATGC</td><td align = "center">reverse</td><td>ACATTTGTATTAATTTCTATGGCCTATGGGGTTAGTGTTTGGACTGTCAAGGTGTGAGGCATCTTCTCAGTGACTGTG<font color="red">CATGC</font></td><td><font color="red">CATGC</font>ATGGTGGGGTGTAGTAGTAGTTTATCAGGACCAAAGAAAAGAACAAACTGCAAGCTAGCTGTAAGCTGCAAAGTATC</td><td align = "right">1</td><td align = "right">23</td><td align = "right">0</td><td align = "center">M</td></tr>
<tr><td align = "center">chr10</td><td align = "right">19069889</td><td align = "right">19069885</td><td align = "center">5</td><td align = "center">ACTTG</td><td align = "center">forward</td><td>GCACAAACAGAAATTCCAAAGTTAAAAGATTTTCTCACCAATAACCTATGGTATCTACCATTATATATCATCAGCAC<font color="red">ACTTG</font></td><td><font color="red">ACTTG</font>TACTCTGTGAAAATAGATTTCAGTAGTATGGTTATTGACACTGACAGAGCTGCTTGCTCAATACAATGTGTTTC</td><td align = "right">3</td><td align = "right">10</td><td align = "right">54</td><td align = "center">H</td></tr>
<tr><td align = "center">chr10</td><td align = "right">21583058</td><td align = "right">21583054</td><td align = "center">5</td><td align = "center">CTTAT</td><td align = "center">forward</td><td>GCTTATGGAGGTCGAGGTGGAGTTGCCAACAGCTCATTCTGTAAATCTATCTTCAAGTCCGAGCTCGAGGTA<font color="red">CTTAT</font></td><td><font color="red">CTTAT</font>CATATCCTCAAATTAGCTAGCCCCCCTATCGAGAATAGCTTAGCATATTTGAGGACCTGTTGGGAGATTGGGAGGT</td><td align = "right">3</td><td align = "right">9</td><td align = "right">22</td><td align = "center">H</td></tr>
<tr><td align = "center">chr12</td><td align = "right">2155895</td><td align = "right">2155899</td><td align = "center">5</td><td align = "center">GGAAC</td><td align = "center">reverse</td><td>AACATTAAATTTAGCTGAGATAATCTTGTTTTGCGACAAAGTTGATGTATTATAGAATGATTCCTTGAATTGCAGCTT<font color="red">GGAAC</font></td><td><font color="red">GGAAC</font>AATTTGGCTTTGTGTAGCACATAAATAAAACATCTTACTATTTAATGTGAACCAGCCAAACTTTGACCCTTGATGT</td><td align = "right">1</td><td align = "right">17</td><td align = "right">82</td><td align = "center">H</td></tr>
</table>
<h2>Book</h2>
<a href = "https://www.springer.com/gp/book/9781071611333" target = "_blank">Plant transposable Elements, Methods in Molecular Biology, Cho, Jungnam (Ed.), 2021, Springer.</a>
<h2>Contact</h2>
Akio Miyao, Ph.D (<a href = "mailto:miyao@affrc.go.jp">miyao@affrc.go.jp</a>)<br>
Institute of Crop Science / <a href = "http://www.naro.affrc.go.jp/english/index.html" target = "_blank">NARO</a><br>
2-1-2, Kannondai, Tsukuba, Ibaraki, 305-8518, Japan
  </body>
</html>
