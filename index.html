<html>
  <head>
    <link rel = "stylesheet" href = "default.css">
  </head>
  <body>
<h1>Transopson Insertion Finder (TIF) <font size = "4"> - An efficient detector for insertions of transposable element from NGS data</font></h1>
TIF detectes transposition of transpososable elements from sequence data of NGS. This page explains how to use TIF, using the transposition detection of the rice endogenous retrotransposon <i>Tos17</i> as an example.<br>
Code: <a href = "https://github.com/akiomiyao/tif" target = "_blank">https://github.com/akiomiyao/tif</a><br>
Paper: <a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-15-71" target = "_blank">Nakagome M, Solovieva E, Takahashi A, Yasue H, Hirochika H, Miyao A (2014) Transposon Insertion Finder (TIF): a novel program for detection of de novo transpositions of transposable elements. BMC Bioinformatics 5:71.</a>
<h2><i>Tos17</i> in the last century</h2>
<p><img src = "tos17.gif" align = "left">
<i>Tos17</i> is an endogenous retrotransposon of rice. <i>Tos17</i> is active only in cultured cells of <i>japonica</i> rice cultivar Nipponbare (<a href = "https://doi.org/10.1073/pnas.93.15.7783" target = "_blank">Hirochika <i>et al.</i> 1996</a>). Taking advantage of this property, we created about 50,000 lines of mutant panels from rice individuals regenerated from cultured cells (<a href = "https://doi.org/10.1105/tpc.012559" target = "_blank">Miyao <i>et al.</i> 2003</a>). Insertion sites of <i>Tos17</i> is determined by <a href = "https://doi.org/10.5511/plantbiotechnology.15.253" target = "_blank">the Suppression PCR method and TAIL-PCR method</a>, and is published in the <a href = "https://tos.nias.affrc.go.jp/" target = "_blank">mutant panel database</a>. <i>Tos17</i> insertion mutant lines have been distributed to researchers around the world and is <a href = "https://scholar.google.com/scholar?hl=ja&as_sdt=0%2C5&q=tos17&btnG=" target = "_blank">useful for functional analysis of genes</a>.
<p>Before the development of NGS technology, primer set of a primer having a <i>Tos17</i> sequence near the end of <i>Tos17</i> and  a primer with a special modification at the end, or a short primer with the elaborate reaction cycles was used to amplify the DNA fragment containing the flanking sequence of <i>Tos17</i> insertion point. Amplified fragments were separated by agarose gel electrophoresis, and the DNA obtained from the gel block containing the fragment was used as a template to determine the flanking sequence of <i>Tos17</i> insertion point by the Sanger method.
<p>We tried to determine insertion positions of <i>Tos17</i> for all 50,000 lines. It was costly and required several years. Furthermore, amplification of flanking sequences depends on recognition sites of restriction enzyme or by-chance primer annealing, making it difficult to cover all insertion sites.
<h2><i>Tos17</i> in this century with NGS</h2>
<p>NGS technology has made it possible to obtain the entire genome sequence of rice individuals. The junction created by <i>Tos17</i> insertion should also be included in the large number of short reads. Sequences having a junction with <i>Tos17</i> can be easily selected by searching the sequences at both ends of <i>Tos17</i>. It is known that a 5-base duplication occurs at the target site during the insertion of <i>Tos17</i>. <a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-15-71/figures/1" target = "_blank">The insertion site of <i>Tos17</i> can be known by selecting a set having the same 5 base target site duplication (TSD) in the 5'-end and the 3'-end-flankng sequence of <i>Tos17</i></a>. TIF selects short reads containing 5'-end and 3'-end sequence of transposable element, makes set of 5'-end and the 3'-end-flankng sequence having same TSD sequence, and then output inserted position on the reference genome by mapping pair of flanking seqeunces.
<h2>Detection of <i>Tos17</i> insertion from NGS data</h2>
<p>Once the NGS sequence data of the <i>Tos17</i> insertion mutant individual is obtained, the insertion site can be easily obtained by the <a href = "https://github.com/akiomiyao/tif" target = "_blank">TIF</a> program. A computer running unix (<a href = "https://ubuntu.com" target = "_blank">ubuntu</a> is good), NGS data, and the rice reference genome sequence (<a href = "https://rapdb.dna.affrc.go.jp/download/irgsp1.html" target = "_blank">IRGSP1.0</a>) are required.
<p>Following is an example.
<p>To obtain short read sequence, fastq-dump is required. <a href = "https://akiomiyao.github.io/ped/sratoolkit/index.html" target = "_blank">Link to fastq-dump setup</a> 
<pre>$ git clone https://github.com/akiomiyao/tif.git
$ cd git
$ mkdir ttm5
$ mkdir ttm5/read
$ cd ttm5/read
$ fastq-dump --split-files SRR556174   # Fastq-dump takes long time.
$ fastq-dump --split-files SRR556175

$ cd git
$ wget https://rapdb.dna.affrc.go.jp/download/archive/irgsp1/IRGSP-1.0_genome.fasta.gz
$ perl tif.pl IRGSP-1.0_genome.fasta.gz  ttm5 TGTTAAATATATATACA TTGCAAGTTAGTTAAGA
</pre>
<p>'<a href = "https://doi.org/10.1186/1471-2229-10-175" target = "_blank">ttm5</a>' is one of the <i>Tos17</i> insertion line (line name: ND6834). The NGS data of ttm5 was acquired for <a href = "https://doi.org/10.1093/pcp/pcr172" target = "_blank">the analysis of somaclonal variation</a>. ND6834 was harvested as a regenerated individual in October 1998. The individual was regenerated from liquid culture in N6 medium containing 2,4-dichlorophenoxyacetic acid at a concentration of 1 mg/L until March 1998 from the Nipponbare calus induced in October 1997. The individual analyzed by NGS is the M<sub>4</sub> generation, two generations after the harvested seeds. <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=SRR556174" target = "_blank">SRR556174</a> and <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=SRR556175" target = "_blank">SRR556175</a> are run data of ttm5 by Illumina Hiseq2000 sequencing system.
<p>$ perl tif.pl<br>
without argument returns how to use tif.pl.<br>
'$' at the head of line indicates prompt of terminal window.
<p>$ perl tif.pl reference target_directory 5'-end_of_TE_sequence 3'-end_of_TE_sequence<br>
For analysis of rice, IRGSP-1.0_genome.fasta.gz is the reference genome sequence.<br>
<i>Tos17</i> 5'-end (Head) sequence: TGTTAAATATATATACA<br>
<i>Tos17</i> 3'-end (Tail) sequence: TTGCAAGTTAGTTAAGA<br>
<p>Result of tif.pl is saved in target (ttm5) directory.
<pre>
miyao@s3:~/tif/ttm5$ ls -la
total 424
drwxrwxr-x 4 miyao miyao  40960 Apr 21 19:13 ./
drwxrwxr-x 6 miyao miyao   4096 Apr 21 19:10 ../
drwxrwxr-x 2 miyao miyao   4096 Apr 21 19:13 child/
-rw-rw-r-- 1 miyao miyao 264216 Apr 21 19:10 grep.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
-rw-rw-r-- 1 miyao miyao  46230 Apr 21 19:13 log.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
drwxrwxr-x 2 miyao miyao   4096 Apr 21 13:56 read/
-rw-rw-r-- 1 miyao miyao   2380 Apr 21 19:13 result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
-rw-rw-r-- 1 miyao miyao  55348 Apr 21 19:12 selected.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA
</pre>
<p>grep.head_seq.tail_seq is a list of short reads containing head_seq or tail_seq.<br>
selected.head_seq.tail_seq is a list of short reads which are not present in the reference genome sequence.<br>
log.head_seq.tail_seq is a log of run.<br>
result.head_seq.tail_seq is the result of tif analysis.<br><br>

<b>Table 1.</b> Table of <i>Tos17</i> transposed positions in ttm5. TAB separated result.TGTTAAATATATATACA.TTGCAAGTTAGTTAAGA data is converted to the table.
<table border>
<tr><th>Chr</th><th>Junction of head</th><th>Junction of tail</th><th>TSD size</th><th>TSD</th><th>Direction</th><th>Head flanking sequence (HFS)</th><th>Tail flanking sequence of tail (TFS)</th><th>Detected number of HFS</th><th>Detected number of TFS</th></tr>
<tr><td>chr01</td><td align = "right">34453641</td><td align = "right">34453645</td><td align = "center">5</td><td>CTTTG</td><td align = "center">reverse</td><td>AGCAAGAAGTATCTCATCAGAGCCACCTTCACTTATGGAAACTACGATGGGCTCAACTCGTCAGAGAAGGGTTCTTTG</td><td>CTTTGTTTATCTTTGGACTCCATATCGGTGTCAACTTCTGGACGACGGTAAACTTGACAAAGTGGGATCCATCGA</td><td align = "right">2</td><td align = "right">18</td>
<tr><td>chr02</td><td align = "right">1004765</td><td align = "right">1004769</td><td align = "center">5</td><td>ATACC</td><td align = "center">reverse</td><td>AAATTTGAGATATACCATCCTGACCCACATGTCATTGACTCATGTGGGTTCTACATGTCATTGATATACC</td><td>ATACCAATGGCATATCTCAAACTTTGCAAAATTATAATGGCATGGCTCCAATTTACCCTTTT</td><td align = "right">1</td><td align = "right">9</td>
<tr><td>chr02</td><td align = "right">31596632</td><td align = "right">31596628</td><td align = "center">5</td><td>CTAAT</td><td align = "center">forward</td><td>CAAACACCGTGTAATTTAGAGGGATGCTATATAACGGAATCTCGTTCAGACGGGATGATACCTACGAGGTATAAGTTCTAAT</td><td>CTAATACCTGTGAGAGTATCGACTTCAGATACCGGTGAGTATTGAATGATTCATGCGAGCTATCA</td><td align = "right">4</td><td align = "right">11</td>
<tr><td>chr03</td><td align = "right">741222</td><td align = "right">741226</td><td align = "center">5</td><td>GCAGC</td><td align = "center">reverse</td><td>AACCGGCTGTCGGATGTGTTTACTGTGTTTGCTGGACATTTGGCAATCAACGTTGGTGGTGGCAGC</td><td>GCAGCCAGGGTTCCATCCCTTCCAGCTCAGGTGGATCGAGCTGTAGAATCTCTGGTTCACCATAAGTTAG</td><td align = "right">1</td><td align = "right">12</td>
<tr><td>chr03</td><td align = "right">8304674</td><td align = "right">8304678</td><td align = "center">5</td><td>GAATA</td><td align = "center">reverse</td><td>GCATAAAGAGTGAATCTCATTGAAGGAACAAAATGAACATTTCAATTTTTTTCAGCAGTCTCGGTAATCAAAGTTATGAATA</td><td>GAATATACCATTGCTCTATAGCACCTCTCTCTGGCAAAATATTAGCATTTTGTCTCAAGACCTCCTTATGACACTATAT</td><td align = "right">2</td><td align = "right">15</td>
<tr><td>chr06</td><td align = "right">24967877</td><td align = "right">24967881</td><td align = "center">5</td><td>TGCAT</td><td align = "center">reverse</td><td>GGAAATGATAGAGTTGCCAGAATTGGCAGAATGGTCTTCTGTGGACTGTTTTTTTCCTGCTCTTCTTGAGGTGTGCAT</td><td>TGCATCAGAGGATGCCCCAAGCTGAAACAATTGCCACCAGTTGTTCTCCCACCTGTAAGAATGAGTATATATGTATCTACC</td><td align = "right">3</td><td align = "right">19</td>
<tr><td>chr07</td><td align = "right">20064395</td><td align = "right">20064391</td><td align = "center">5</td><td>CTTAT</td><td align = "center">forward</td><td>TCGCTCACAGTGGAGGACATTGTGGACAATGCAATCGTACTCCTGACTGCCGGTTATGGGAATTCGGCTGTTCTTAT</td><td>CTTATCACCTTCTTGCTCCGGTACCTAGCTAATGATCCAGACATCCTTGGCAAGATAACCGAGGGTGAGCACCTAGTACTCT</td><td align = "right">4</td><td align = "right">24</td>
<tr><td>chr07</td><td align = "right">20080556</td><td align = "right">20080552</td><td align = "center">5</td><td>CTTAT</td><td align = "center">forward</td><td>TCGCTCACAGTGGAGGACATTGTGGACAATGCAATCGTACTCCTGACTGCCGGTTATGGGAATTCGGCTGTTCTTAT</td><td>CTTATCACCTTCTTGCTCCGGTACCTAGCTAATGATCCAGACATCCTTGGCAAGATAACCGAGGGTGAGCACCTAGTACTCT</td><td align = "right">4</td><td align = "right">24</td>
<tr><td>chr09</td><td align = "right">12970614</td><td align = "right">12970618</td><td align = "center">5</td><td>CATGC</td><td align = "center">reverse</td><td>ACATTTGTATTAATTTCTATGGCCTATGGGGTTAGTGTTTGGACTGTCAAGGTGTGAGGCATCTTCTCAGTGACTGTGCATGC</td><td>CATGCATGGTGGGGTGTAGTAGTAGTTTATCAGGACCAAAGAAAAGAACAAACTGCAAGCTAGCTGTAAGCTGCAAAGTAT</td><td align = "right">1</td><td align = "right">19</td>
<tr><td>chr10</td><td align = "right">19069889</td><td align = "right">19069885</td><td align = "center">5</td><td>ACTTG</td><td align = "center">forward</td><td>CAAAGTTAAAAGATTTTCTCACCAATAACCTATGGTATCTACCATTATATATCATCAGCACACTTG</td><td>ACTTGTACTCTGTGAAAATAGATTTCAGTAGTATGGTTATTGACACTGACAGAGCTGCTTGCTCAATACAATGTGTTTC</td><td align = "right">2</td><td align = "right">8</td>
<tr><td>chr10</td><td align = "right">21583058</td><td align = "right">21583054</td><td align = "center">5</td><td>CTTAT</td><td align = "center">forward</td><td>ATGGAGGTCGAGGTGGAGTTGCCAACAGCTCATTCTGTAAATCTATCTTCAAGTCCGAGCTCGAGGTACTTAT</td><td>CTTATCATATCCTCAAATTAGCTAGCCCCCCTATCGAGAATAGCTTAGCATATTTGAGGACCTGTTGGG</td><td align = "right">2</td><td align = "right">7</td>
<tr><td>chr12</td><td align = "right">2155895</td><td align = "right">2155899</td><td align = "center">5</td><td>GGAAC</td><td align = "center">reverse</td><td>TTAAATTTAGCTGAGATAATCTTGTTTTGCGACAAAGTTGATGTATTATAGAATGATTCCTTGAATTGCAGCTTGGAAC</td><td>GGAACAATTTGGCTTTGTGTAGCACATAAATAAAACATCTTACTATTTAATGTGAACCAGCCAAACTTTGACCCTTGATGT</td><td align = "right">4</td><td align = "right">12</td>
</table>



<h2>Contact</h2>
MIYAO Akio, Ph.D (<a href = "mailto:miyao@affrc.go.jp">miyao@affrc.go.jp</a>) (Family name is MIYAO)<br>
Institute of Crop Science / <a href = "http://www.naro.affrc.go.jp/english/index.html" target = "_blank">NARO</a><br>
2-1-2, Kannondai, Tsukuba, Ibaraki, 305-8518, Japan
  </body>
</html>
